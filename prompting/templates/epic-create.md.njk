{#
variables:
  epicTitle: string     # Epic title
  prdId: string         # Parent PRD ID
  prdTitle: string|null # PRD title (optional)
  mode: worktree|inline # Execution mode
  sandbox: boolean      # Running in sandbox
  role: coordinator     # Actor role
  memory: string|null   # PRD memory (optional)
#}
# Create Epic: {{ epicTitle }}

PRD: {{ prdId }}{% if prdTitle %} - {{ prdTitle }}{% endif %}

---

## Your Role

You are the **coordinator** creating a new epic.

- ✅ Define clear scope
- ✅ Set acceptance criteria
- ✅ Identify dependencies
- ❌ DO NOT create tasks yet

---

## Creating the Epic

{% if sandbox %}
```json
{ "command": "epic:create {{ prdId }} \"{{ epicTitle }}\"" }
```
{% else %}
```bash
rudder epic:create {{ prdId }} "{{ epicTitle }}"
```
{% endif %}

This creates `ENNN/epic.md` under the PRD.

---

## Editing Epic Content

{% if sandbox %}
```json
{ "command": "epic:edit ENNN -s \"## Description\" -c \"Epic description\"" }
{ "command": "epic:edit ENNN -s \"## Acceptance Criteria\" -c \"- [ ] Criterion\"" }
```
{% else %}
```bash
rudder epic:edit ENNN -s "## Description" -c "Epic description"
rudder epic:edit ENNN -s "## Acceptance Criteria" -c "- [ ] Criterion"

# Or with patch:
cat <<'PATCH' | rudder epic:patch ENNN
<<<<<<< SEARCH
## Description
=======
## Description

Clear description of what this epic delivers.
>>>>>>> REPLACE
PATCH
```
{% endif %}

---

## Epic Structure

A good epic includes:

1. **Description** - What does this epic deliver?
2. **Acceptance Criteria** - How do we know it's done?
3. **Technical Notes** - Architecture decisions, constraints
4. **Dependencies** - What must exist first?

---

## Setting Dependencies

{% if sandbox %}
```json
{ "command": "deps:add ENNN --blocked-by EXXX" }
```
{% else %}
```bash
rudder deps:add ENNN --blocked-by EXXX
```
{% endif %}

---

## Assign to Milestone

{% if sandbox %}
```json
{ "command": "prd:milestone {{ prdId }} M1 --add-epic ENNN" }
```
{% else %}
```bash
rudder prd:milestone {{ prdId }} M1 --add-epic ENNN
```
{% endif %}

---

## Next Steps

After epic is defined:
1. Run `/dev:epic-breakdown ENNN` to create tasks
2. Or spawn agent: `agent:spawn ENNN --operation epic-breakdown`

{% if memory %}
---

# PRD Memory

{{ memory }}
{% endif %}
